{
  "id": "fastapi-postgres",
  "name": "FastAPI + PostgreSQL + Redis",
  "description": "Modern async FastAPI application with PostgreSQL database, Redis cache, Celery workers, Prometheus metrics, and auto-generated OpenAPI documentation",
  "category": "Backend / Python Async API",
  "tags": ["Python", "FastAPI", "PostgreSQL", "Redis", "Celery", "Prometheus", "Async", "REST API", "OpenAPI", "WebSocket"],
  "dockerCompose": "version: '3.8'\n\nservices:\n  # FastAPI Application\n  fastapi-app:\n    image: python:3.11-slim\n    container_name: fastapi-app\n    ports:\n      - \"8000:8000\"\n    environment:\n      - APP_ENV=production\n      - DATABASE_URL=postgresql+asyncpg://fastapiuser:fastapipass@postgres:5432/fastapidb\n      - REDIS_URL=redis://:redispass@redis:6379/0\n      - CELERY_BROKER_URL=redis://:redispass@redis:6379/1\n      - CELERY_RESULT_BACKEND=redis://:redispass@redis:6379/2\n      - SECRET_KEY=change-me-in-production-please-use-env-var\n      - API_V1_PREFIX=/api/v1\n      - CORS_ORIGINS=[\"http://localhost:3000\",\"https://yourdomain.com\"]\n      - LOG_LEVEL=info\n      - WORKERS=4\n    volumes:\n      - ./app:/app\n    working_dir: /app\n    command: >\n      sh -c \"pip install --no-cache-dir -r requirements.txt &&\n             alembic upgrade head &&\n             uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4 --log-level info --proxy-headers --forwarded-allow-ips='*'\"\n    depends_on:\n      - postgres\n      - redis\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\n  # Celery Worker (Background Tasks)\n  celery-worker:\n    image: python:3.11-slim\n    container_name: fastapi-celery-worker\n    environment:\n      - APP_ENV=production\n      - DATABASE_URL=postgresql+asyncpg://fastapiuser:fastapipass@postgres:5432/fastapidb\n      - REDIS_URL=redis://:redispass@redis:6379/0\n      - CELERY_BROKER_URL=redis://:redispass@redis:6379/1\n      - CELERY_RESULT_BACKEND=redis://:redispass@redis:6379/2\n      - SECRET_KEY=change-me-in-production-please-use-env-var\n      - CELERY_WORKER_CONCURRENCY=4\n    volumes:\n      - ./app:/app\n    working_dir: /app\n    command: >\n      sh -c \"pip install --no-cache-dir -r requirements.txt &&\n             celery -A worker.celery worker --loglevel=info --concurrency=4 --max-tasks-per-child=100\"\n    depends_on:\n      - postgres\n      - redis\n    healthcheck:\n      test: [\"CMD-SHELL\", \"celery -A worker.celery inspect ping\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 20s\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\n  # Celery Beat (Scheduled Tasks)\n  celery-beat:\n    image: python:3.11-slim\n    container_name: fastapi-celery-beat\n    environment:\n      - APP_ENV=production\n      - DATABASE_URL=postgresql+asyncpg://fastapiuser:fastapipass@postgres:5432/fastapidb\n      - REDIS_URL=redis://:redispass@redis:6379/0\n      - CELERY_BROKER_URL=redis://:redispass@redis:6379/1\n      - CELERY_RESULT_BACKEND=redis://:redispass@redis:6379/2\n      - SECRET_KEY=change-me-in-production-please-use-env-var\n    volumes:\n      - ./app:/app\n    working_dir: /app\n    command: >\n      sh -c \"pip install --no-cache-dir -r requirements.txt &&\n             celery -A worker.celery beat --loglevel=info\"\n    depends_on:\n      - redis\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\n  # PostgreSQL Database\n  postgres:\n    image: postgres:15-alpine\n    container_name: fastapi-postgres\n    ports:\n      - \"5432:5432\"\n    environment:\n      - POSTGRES_DB=fastapidb\n      - POSTGRES_USER=fastapiuser\n      - POSTGRES_PASSWORD=fastapipass\n      - POSTGRES_INITDB_ARGS=--encoding=UTF-8\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n      - ./init-scripts:/docker-entrypoint-initdb.d\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U fastapiuser -d fastapidb\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\n  # Redis (Cache + Session + Celery Broker)\n  redis:\n    image: redis:7-alpine\n    container_name: fastapi-redis\n    ports:\n      - \"6379:6379\"\n    command: redis-server --appendonly yes --requirepass redispass --maxmemory 512mb --maxmemory-policy allkeys-lru\n    volumes:\n      - redis-data:/data\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"--raw\", \"incr\", \"ping\"]\n      interval: 10s\n      timeout: 3s\n      retries: 5\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\n  # Prometheus (Metrics Collection)\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: fastapi-prometheus\n    ports:\n      - \"9090:9090\"\n    volumes:\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro\n      - prometheus-data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--storage.tsdb.retention.time=15d'\n      - '--web.console.libraries=/usr/share/prometheus/console_libraries'\n      - '--web.console.templates=/usr/share/prometheus/consoles'\n    depends_on:\n      - fastapi-app\n    healthcheck:\n      test: [\"CMD\", \"wget\", \"--quiet\", \"--tries=1\", \"--spider\", \"http://localhost:9090/-/healthy\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    networks:\n      - fastapi-network\n    restart: unless-stopped\n\nvolumes:\n  postgres-data:\n    driver: local\n  redis-data:\n    driver: local\n  prometheus-data:\n    driver: local\n\nnetworks:\n  fastapi-network:\n    driver: bridge\n",
  "recommendedOptions": {
    "targetPlatform": "kubernetes",
    "proxyType": "traefik",
    "addHealthChecks": true,
    "addResourceLimits": true,
    "resourceProfile": "medium",
    "addSecurity": true
  }
}
