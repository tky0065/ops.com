{
  "id": "spring-boot-postgres",
  "name": "Spring Boot + PostgreSQL + Kafka",
  "description": "Production-ready Spring Boot microservice with PostgreSQL database, Redis cache, Kafka message broker, and Prometheus monitoring",
  "category": "Backend / Java Enterprise",
  "tags": ["Java", "Spring Boot", "PostgreSQL", "Redis", "Kafka", "Prometheus", "Grafana", "Microservices", "Enterprise"],
  "dockerCompose": "version: '3.8'\n\nservices:\n  # Spring Boot Application\n  spring-app:\n    image: openjdk:17-jdk-alpine\n    container_name: spring-app\n    ports:\n      - \"8080:8080\"\n      - \"9090:9090\"  # Actuator/metrics\n    environment:\n      - SPRING_PROFILES_ACTIVE=prod\n      - SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/springdb\n      - SPRING_DATASOURCE_USERNAME=springuser\n      - SPRING_DATASOURCE_PASSWORD=springpass\n      - SPRING_REDIS_HOST=redis\n      - SPRING_REDIS_PORT=6379\n      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:9092\n      - MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus\n      - MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true\n      - JAVA_OPTS=-Xmx512m -Xms256m\n    volumes:\n      - ./app:/app\n    working_dir: /app\n    command: [\"java\", \"-jar\", \"application.jar\"]\n    depends_on:\n      - postgres\n      - redis\n      - kafka\n    healthcheck:\n      test: [\"CMD\", \"wget\", \"--quiet\", \"--tries=1\", \"--spider\", \"http://localhost:8080/actuator/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  # PostgreSQL Database\n  postgres:\n    image: postgres:15-alpine\n    container_name: spring-postgres\n    ports:\n      - \"5432:5432\"\n    environment:\n      - POSTGRES_DB=springdb\n      - POSTGRES_USER=springuser\n      - POSTGRES_PASSWORD=springpass\n      - POSTGRES_INITDB_ARGS=--encoding=UTF-8 --lc-collate=en_US.UTF-8 --lc-ctype=en_US.UTF-8\n    volumes:\n      - postgres-data:/var/lib/postgresql/data\n      - ./init-scripts:/docker-entrypoint-initdb.d\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U springuser -d springdb\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  # Redis Cache\n  redis:\n    image: redis:7-alpine\n    container_name: spring-redis\n    ports:\n      - \"6379:6379\"\n    command: redis-server --appendonly yes --requirepass redispass\n    environment:\n      - REDIS_PASSWORD=redispass\n    volumes:\n      - redis-data:/data\n    healthcheck:\n      test: [\"CMD\", \"redis-cli\", \"--raw\", \"incr\", \"ping\"]\n      interval: 10s\n      timeout: 3s\n      retries: 5\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  # Apache Kafka (with Zookeeper)\n  zookeeper:\n    image: confluentinc/cp-zookeeper:7.5.0\n    container_name: spring-zookeeper\n    environment:\n      ZOOKEEPER_CLIENT_PORT: 2181\n      ZOOKEEPER_TICK_TIME: 2000\n    volumes:\n      - zookeeper-data:/var/lib/zookeeper/data\n      - zookeeper-logs:/var/lib/zookeeper/log\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  kafka:\n    image: confluentinc/cp-kafka:7.5.0\n    container_name: spring-kafka\n    ports:\n      - \"9092:9092\"\n      - \"29092:29092\"\n    environment:\n      KAFKA_BROKER_ID: 1\n      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181\n      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092,PLAINTEXT_HOST://localhost:29092\n      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT\n      KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT\n      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1\n      KAFKA_AUTO_CREATE_TOPICS_ENABLE: \"true\"\n      KAFKA_LOG_RETENTION_HOURS: 168\n    volumes:\n      - kafka-data:/var/lib/kafka/data\n    depends_on:\n      - zookeeper\n    healthcheck:\n      test: [\"CMD\", \"kafka-broker-api-versions\", \"--bootstrap-server\", \"localhost:9092\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n      start_period: 30s\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  # Prometheus (Metrics Collection)\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: spring-prometheus\n    ports:\n      - \"9091:9090\"\n    volumes:\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml\n      - prometheus-data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--web.console.libraries=/usr/share/prometheus/console_libraries'\n      - '--web.console.templates=/usr/share/prometheus/consoles'\n    networks:\n      - spring-network\n    restart: unless-stopped\n\n  # Grafana (Monitoring Dashboard)\n  grafana:\n    image: grafana/grafana:latest\n    container_name: spring-grafana\n    ports:\n      - \"3000:3000\"\n    environment:\n      - GF_SECURITY_ADMIN_USER=admin\n      - GF_SECURITY_ADMIN_PASSWORD=admin\n      - GF_INSTALL_PLUGINS=grafana-piechart-panel\n    volumes:\n      - grafana-data:/var/lib/grafana\n      - ./grafana/provisioning:/etc/grafana/provisioning\n    depends_on:\n      - prometheus\n    networks:\n      - spring-network\n    restart: unless-stopped\n\nvolumes:\n  postgres-data:\n    driver: local\n  redis-data:\n    driver: local\n  zookeeper-data:\n    driver: local\n  zookeeper-logs:\n    driver: local\n  kafka-data:\n    driver: local\n  prometheus-data:\n    driver: local\n  grafana-data:\n    driver: local\n\nnetworks:\n  spring-network:\n    driver: bridge\n",
  "recommendedOptions": {
    "targetPlatform": "kubernetes",
    "proxyType": "traefik",
    "addHealthChecks": true,
    "addResourceLimits": true,
    "resourceProfile": "large",
    "addSecurity": true
  }
}
